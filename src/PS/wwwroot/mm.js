"use strict";function initializeGoogleMap(e,t,r,o,a,n){return googleMapHolder="",googleMapHolder=t,displayCurrentLocation=o,locationCall=a,""!==e&&(autocomplete=new google.maps.places.Autocomplete(document.getElementById(e),{types:["geocode"]}),""!=r&&google.maps.event.addListener(autocomplete,"place_changed",function(){r(autocomplete)})),navigator.geolocation?navigator.geolocation.getCurrentPosition(showMap,handleError):error("Google Map is not supported"),draggable=n?n:!1,autocomplete}function showMap(e){var t=e.coords.latitude,r=e.coords.longitude;if(latlon=new google.maps.LatLng(t,r),mapOptions.center=latlon,locateCityAndArea(latlon),displayCurrentLocation&&(mapOptions.zoom=12),map=new google.maps.Map(document.getElementById(googleMapHolder),mapOptions),displayCurrentLocation){var o=new google.maps.Marker({position:latlon,map:map,title:"You are here!",draggable:draggable});infowindow.setContent("You are here!"),infowindow.open(map,o),draggable&&google.maps.event.addListener(o,"drag",function(){var e=new google.maps.LatLng(o.position.lat(),o.position.lng());locateCityAndArea(e)})}}function handleError(e){getLatLng("India")}function loadMap(e,t,r){r||(r=4),latlon=new google.maps.LatLng(e,t),mapOptions.center=latlon,mapOptions.zoom=r,map=new google.maps.Map(document.getElementById(googleMapHolder),mapOptions)}function loadCurrentLocation(e){locationCall&&locationCall(e.city,e.area)}function locateCityAndArea(e){var t={latLng:e};callGeoCoderApi(t).then(function(e){var t=getCityAreaFromAddressComponent(e.result);loadCurrentLocation(t)})}function getCityAreaFromAddressComponent(e){for(var t,r,o,a,n,s,i,c,l,d,p,u,m,g=0;g<e.address_components.length;g++)for(var f=0;f<e.address_components[g].types.length;f++)if("route"==e.address_components[g].types[f]&&(t=e.address_components[g].long_name),"street_number"==e.address_components[g].types[f]&&(r=e.address_components[g].long_name),"neighborhood"==e.address_components[g].types[f]&&(o=e.address_components[g].long_name),"sublocality_level_3"==e.address_components[g].types[f]&&(a=e.address_components[g].long_name),"sublocality_level_2"==e.address_components[g].types[f]&&(n=e.address_components[g].long_name),"sublocality_level_1"==e.address_components[g].types[f]&&(i=e.address_components[g].long_name),"locality"==e.address_components[g].types[f]&&(c=e.address_components[g].long_name),"administrative_area_level_2"==e.address_components[g].types[f]&&(s=e.address_components[g].long_name),"administrative_area_level_1"==e.address_components[g].types[f]&&(d=e.address_components[g].long_name),"country"==e.address_components[g].types[f]&&(l=e.address_components[g].long_name),"postal_code"==e.address_components[g].types[f]){p=e.address_components[g].long_name;break}return t=t?t:"",r=r?r:"",o=o?o:"",a=a?a:"",n=n?n:"",c=c?c:"",u=t,m=r+" "+o+", "+a+" "+n+" ,"+i+", "+c,{city:s,area:i,locality:c,state:d,country:l,pinCode:p,addressLine1:u,addressLine2:m}}function getLatLng(e,t){var r={address:e};callGeoCoderApi(r).then(function(e){var r=e.result.geometry.location.lat(),o=e.result.geometry.location.lng();loadMap(r,o,t)})}function callGeoCoderApi(e){var t=new $.Deferred;return geocoder.geocode(e,function(e,r){if(r==google.maps.GeocoderStatus.OK)if(e[0]){var o={result:e[0]};t.resolve(o)}else alert("No results found"),t.reject();else t.reject()}),t.promise()}function fillInAddress(e){var t=e.getPlace();console.log(t.geometry.location.lng());for(var r in componentForm)document.getElementById(r).value="","administrative_area_level_2"!=r&&"administrative_area_level_1"!=r&&"country"!=r&&"postal_code"!=r&&(document.getElementById(r).disabled=!1),fillInAddressToTextBox(t.address_components)}function fillInAddressToTextBox(e,t){for(var r=0;r<e.length;r++){var o=e[r].types[0];if(componentForm[o]){var a=e[r][componentForm[o]];document.getElementById(o).value=a}}document.getElementById("formatted_address")&&t&&(document.getElementById("formatted_address").value=t)}function geolocate(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),r=new google.maps.Circle({center:t,radius:e.coords.accuracy});autocomplete.setBounds(r.getBounds())})}function setMarkers(e,t,r){e&&(map=e);var o;googleMapMarkers=[];var a=new google.maps.LatLngBounds;infowindow.close(),$.each(t,function(e,t){var n=t.latitude,s=t.longitude;o=new google.maps.LatLng(n,s);var i=new google.maps.Marker({map:map,position:o});0===e&&map.setCenter(i.getPosition());var c="<div><strong>"+t.name+"</strong><br>"+t.address.line1+","+t.address.line2+"<br>"+t.phoneNo+"</div>";a.extend(i.position),google.maps.event.addListener(i,"click",function(e,t,r,o,a){return function(){t.setContent(a),t.open(map,e),r(o)}}(i,infowindow,r,t,c)),t.activeCentre&&(infowindow.open(map,i),infowindow.setContent(c)),googleMapMarkers.push(i)})}function myClick(e,t){var r;$.each(t,function(t,o){o.$$hashKey==e&&(r=t)}),google.maps.event.trigger(googleMapMarkers[r],"click")}function removeMarker(){for(var e=0;e<googleMapMarkers.length;e++)googleMapMarkers[e].setMap(null);googleMapMarkers=[]}function scrollBackToTop(){var e=300;$(window).scroll(function(){$(window).scrollTop()>e?$("a.back-to-top").fadeIn("slow"):$("a.back-to-top").fadeOut("slow")})}function makeSyickyHeader(){$(document).ready(function(){var e=($(window).height(),$(window).width()),t=767,r=640,o=$("#page-preloader"),a=o.find(".spinner-loader");if(o.show(),a.fadeOut(),o.delay(50).fadeOut("slow"),e>t){var n=$(".layout-theme").data("header"),s=$(".layout-theme").data("header-top");n&&n.length&&$(window).on("scroll",function(){var e=$(window).scrollTop(),t=$(".header");e>s?($(".header").addClass("animated"),$("header").addClass("animation-done"),$(".header").addClass("bounce"),t.addClass("sticky")):($(".header").removeClass("bounce"),$(".header").removeClass("animated"),$(".header").removeClass("animation-done"),t.removeClass("sticky"))})}r>e&&$("body").removeClass("animated-css"),$(".animated-css .animated:not(.animation-done)").waypoint(function(){var e=$(this).data("animation");$(this).addClass("animation-done").addClass(e)},{triggerOnce:!0,offset:"90%"}),$(".dropdown").hover(function(){$(".dropdown-menu",this).stop(!0,!0).slideDown("fast"),$(this).toggleClass("open")},function(){$(".dropdown-menu",this).stop(!0,!0).slideUp("fast"),$(this).toggleClass("open")}),$(".yamm .navbar-nav>li").hover(function(){$(".dropdown-menu",this).fadeIn("fast")},function(){$(".dropdown-menu",this).fadeOut("fast")}),window.prettyPrint&&prettyPrint(),$(document).on("click",".yamm .dropdown-menu",function(e){e.stopPropagation()}),$(document).on("click",".signup-tab",function(e){e.preventDefault(),$("#signup-taba").tab("show")}),$(document).on("click",".signin-tab",function(e){e.preventDefault(),$("#signin-taba").tab("show")}),$(document).on("click",".forgetpass-tab",function(e){e.preventDefault(),$("#forgetpass-taba").tab("show")})})}angular.module("psApp",["index","ui.router","ngStorage"]),angular.module("psApp").directive("script",function(){return{restrict:"E",scope:!1,link:function(e,t,r){if("text/javascript-lazy"==r.type){var o=t.text(),a=new Function(o);a()}}}}),angular.module("psApp").controller("psController",["$rootScope",function(e){e.$on("$routeChangeStart",function(e,t,r,o){var a=$("#page-preloader"),n=a.find(".spinner-loader");a.show(),n.fadeOut(),a.delay(50).fadeOut("slow"),a.hide()})}]),angular.module("psApp").service("LoadingInterceptor",["$q","$rootScope","$log",function(e,t,r){function o(){return n>s}function a(){t.loading=o()}var n=0,s=0;return{request:function(e){return n++,a(),e},requestError:function(t){return s++,a(),r.error("Request error:",t),e.reject(t)},response:function(e){return s++,a(),e},responseError:function(t){return s++,a(),r.error("Response error:",t),e.reject(t)}}}]),angular.module("psApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(e,t,r,o){o.interceptors.push("LoadingInterceptor");var a=[{state:"home",config:{url:"/",controller:"indexController",template:"<ps-index></ps-index>"}},{state:"Contact",config:{url:"/Contact",template:"<ps-contact-us></ps-contact-us>"}},{state:"About",config:{url:"/About",template:"<ps-about-us></ps-about-us>"}},{state:"Pricing",config:{url:"/Pricing",template:"<ps-pricing></ps-pricing>"}},{state:"Dashboard",config:{url:"/Dashboard",requireLogin:!0,template:"<ps-dashboard></ps-dashboard>"}},{state:"Terms",config:{url:"/Terms",template:"<ps-terms></ps-terms>"}},{state:"PrivacyPolicy",config:{url:"/PrivacyPolicy",template:"<ps-privacy-policy></ps-privacy-policy>"}},{state:"service",config:{url:"/Service",template:"<car-service></car-service>"}},{state:"service.car",config:{url:"/",template:"<select-car></select-car>"}},{state:"service.centre",config:{url:"/",requireLogin:!0,template:"<select-centre></select-centre>"}},{state:"service.appointment",config:{url:"/",requireLogin:!0,template:"<book-appointment></book-appointment>"}},{state:"service.address",config:{url:"/",requireLogin:!0,template:"<select-address></select-address>"}},{state:"orderSuccess",config:{url:"/Success",controller:"selectAddressController",template:"<order-summary></order-summary>"}},{state:"socialCallback",config:{url:"/Auth/Success",template:"<div id='page-preloader'><img class='spinner' src='../assets/img/cool-loading-animated.gif' alt='MileMates Loader'></div>",controller:"loginDetailsController"}},{state:"admin",config:{url:"/Admin",template:"<admin></admin>",controller:"loginDetailsController"}}];a.forEach(function(t){e.state(t.state,t.config)}),t.otherwise("/"),r.html5Mode(!0)}]).run(["$rootScope","$state","psLoginService",function(e,t,r){e.$on("$stateChangeStart",function(e,o,a,n,s){o.requireLogin&&!r.isAuthenticated()&&("service.centre"===o.name?$("#loginModal").modal("toggle"):t.go("home"),e.preventDefault())})}]),angular.module("psApp").directive("admin",function(){return{templateUrl:"psapp/admin/admin.html",link:function(e,t,r){$(".jelect").jelect()},controller:["$scope","psDataServices",function(e,t){e.carList={},e.centreDetails={},e.showBrandName=!0;var r={},o=function(){this.ModelList=[],this.MilematePrice=0,this.ActualPrice=0,this.ServiceCentrePrice=0},a=function(){this.Name="",this.Petrol=[],this.Diesel=[],this.CNG=[],this.Electric=[]};t.geMockData().success(function(t){e.centreDetails=t,angular.extend(r,t)}).error(function(){}),t.getAllCarColletion().success(function(t){e.carList.carCollections=t.carList}).error(function(){}),e.selectBrand=function(r){e.showBrandName=!1,e.showModel=!0,e.brand=r,e.modelList=[],t.getCarType(r).success(function(t){e.carList.carTypes=t}).error(function(){})},e.selectModel=function(t){e.modelList=e.modelList||[],e.modelList.includes(t)?e.modelList.splice(e.modelList.indexOf(t),1):e.modelList.push(t)},e.addCentreDetails=function(){var r=new a,n=new o;switch(n.ModelList=e.modelList,n.ActualPrice=e.centreDetails.TotalPrice,n.MilematePrice=e.centreDetails.ActualPrice,n.ServiceCentrePrice=e.centreDetails.ServiceCentrePrice,r.Name=e.service,e.centreDetails.ServiceDetails=[],e.centreDetails.type){case"Petrol":r.Petrol.push(n),e.centreDetails.ServiceDetails.push(r);break;case"Diesel":r.Diesel.push(n),e.centreDetails.ServiceDetails.push(r);break;case"CNG":r.CNG.push(n),e.centreDetails.ServiceDetails.push(r);break;case"Electric":r.Electric.push(n),e.centreDetails.ServiceDetails.push(r)}console.log(e.centreDetails),t.saveCentreDetails(e.centreDetails).success(function(t){alert(t.message),0===t.status&&(e.centreDetails.Id=t.id,e.newCentre=!1)})},e.editBrand=function(){e.showBrandName=!e.showBrandName,e.showModel=!e.showModel}}]}}),angular.module("psApp").directive("carServiceCategory",function(){return{scope:!0,templateUrl:"psApp/carService/carServiceCategory.html"}}),angular.module("psApp").filter("makeId",function(){return function(e){return e?e.replace(/[^a-zA-Z0-9 ]/g,"").replace(/ /g,"_"):""}}),angular.module("psApp").controller("carServiceController",["$scope","$state","$timeout","$localStorage","$rootScope","psDataServices",function(e,t,r,o,a,n){function s(){e.showBrandName||(e.showMakeYears=void 0==e.selectedCar.year||""===e.selectedCar.year?!0:!1,e.showMakeYears||(e.showModel=void 0==e.selectedCar.model||""===e.selectedCar.model?!0:!1),e.showModel||(e.showVarient=void 0==e.selectedCar.varient||""===e.selectedCar.varient?!0:!1))}function i(){n.getAllService().success(function(t){e.services=t,e.serviceOpts.viewMode=e.services.serviceName[0],e.commonServices=e.services.serviceDetails[0],e.car.services=[],e.selectedCar.brand?c(e.selectedCar.brand).then(function(){e.carList.carVarientList=["Petrol","Diesel","CNG","Electric"],e.selectedCar.varient&&(e.car.choose_a_service=!0,e.car.showServiceType=!0,e.serviceOpts.viewMode=e.services.serviceName[0],n.setSelectedCarAndService(e.selectedCar))}):e.showBrandName=!0,r(function(){$.each(e.services.serviceDetails,function(t,r){$.each(r,function(r,o){("Common Services"===e.services.serviceName[t]||"Scheduled Maintenance"===e.services.serviceName[t])&&(o.isSingleSelectJob=!0),e.car.services.push(o)})})},200)}).error(function(){})}function c(t){return n.getCarType(t).success(function(t){e.carList.carTypes=t}).error(function(){})}e.center={},o.userData=o.userData||{},e.searchedText={},e.state=t;var l,d={name:" Describe your problem here",type:[],addText:!0},p=[];e.showBrandName=!1,e.showMakeYears=!1,e.showModel=!1,e.selectedCar=o.userData.car||{},e.car={},e.serviceOpts={},e.selectedJob=[],e.carList={},e.selectBrand=function(t){e.showBrandName=!1,e.showMakeYears=!0,e.showModel=!1,e.showVarient=!1,e.selectedCar.brand!=t&&(e.selectedCar={},e.carList.carTypes={},e.carList.carVarientList={},e.selectedCar.brand=t,n.getCarType(t).success(function(t){e.carList.carTypes=t}).error(function(){}))},e.selectYear=function(t){e.showBrandName=!1,e.showMakeYears=!1,e.showVarient=!1,e.selectedCar.year=""!==t?t:"I Don't Know",e.selectedCar.model||(e.showModel=!0),n.setSelectedCarAndService(e.selectedCar),s()},e.selectModel=function(t){e.showBrandName=!1,e.showMakeYears=!1,e.showModel=!1,""!==t?(e.selectedCar.model=t,e.selectedCar.varient="",e.carList.carVarientList=["Petrol","Diesel","CNG","Electric"],e.showVarient=!0):(e.selectedCar.model="I Don't Know",e.selectedCar.varient="I Don't Know",e.carList.carVarientList={}),o.userData.car=e.selectedCar},e.selectVarient=function(t){e.showBrandName=!1,e.showMakeYears=!1,e.showModel=!1,e.showVarient=!1,e.selectedCar.varient=""!==t?t:"I Don't Know",o.userData.car=e.selectedCar,e.car.choose_a_service=!0,e.car.showServiceType=!0,e.serviceOpts.viewMode=e.services.serviceName[0],n.setSelectedCarAndService(e.selectedCar)},e.editBrand=function(){e.showBrandName=!e.showBrandName,e.showMakeYears=!1,e.showModel=!1,e.showVarient=!1,s()},e.editYear=function(){e.showBrandName=!1,e.showMakeYears=!e.showMakeYears,e.showModel=!1,e.showVarient=!1,e.showMakeYears||s()},e.editModel=function(){e.showBrandName=!1,e.showMakeYears=!1,e.showModel=!e.showModel,e.showVarient=!1,e.showModel||s()},e.editVarient=function(){e.showBrandName=!1,e.showMakeYears=!1,e.showModel=!1,e.showVarient=!e.showVarient},e.commonServices=[],e.changeView=function(t){e.serviceOpts.viewMode=this.service?this.service:"consultation",e.commonServices=e.services.serviceDetails[e.services.serviceName.indexOf(this.service)],"consultation"===e.serviceOpts.viewMode&&(e.selectedJob.includes(d)||e.selectedJob.push(d))},e.addSelectedJob=function(t){if(t.isSingleSelectJob&&!t.selected){var r=e.selectedJob.filter(function(e){return e.isSingleSelectJob===!0});r.length>0&&e.deleteSelectedJob(r[0])}t.selected=!t.selected,e.selectedJob.includes(t)?e.selectedJob.splice(e.selectedJob.indexOf(t),1):e.selectedJob.push(t)},e.deleteSelectedJob=function(t){e.selectedJob.indexOf(t)>-1&&e.selectedJob.splice(e.selectedJob.indexOf(t),1),t.selected=!t.selected,"consultation"===e.serviceOpts.viewMode&&0===e.selectedJob.length&&(e.serviceOpts.viewMode=e.services.serviceName[0],e.commonServices=e.services.serviceDetails[0])},e.chooseAnswer=function(e,t,r){t.answer||(t.answer=[]),t.answer.includes(r)?t.answer.splice(t.answer.indexOf(r),1):(t.isMultiple||(t.answer=[]),t.answer.push(r))},s(),n.getAllCarColletion().success(function(t){e.carList.carCollections=t.carList,e.carList.yearsList=t.yearsList,i()}).error(function(){}),e.showDetails=function(t){e.overlayData=t,$("#detailsModal").modal()},e.setUserJob=function(){var r=[];$.each(e.selectedJob,function(e,t){r.push(t.name)}),n.setSelectedCarAndService(e.selectedCar,e.selectedJob),n.setSelectedServiceName(r),n.getuserDetails()?t.go("service.centre"):$("#loginModal").modal("toggle")},t.go("service.car"),e.state=t,e.search=function(){l||(l=e.serviceOpts.viewMode,p=e.commonServices),e.searchedText.name&&e.searchedText.name.length>0?(e.commonServices=e.car.services,e.serviceOpts.viewMode="search"):e.clearSearch()},e.clearSearch=function(){e.serviceOpts.viewMode=l,e.commonServices=p,l=void 0,e.searchedText.name="",l=void 0},e.setDefault=function(){n.setUserPreference()}}]),angular.module("psApp").directive("carService",function(){return{templateUrl:"psApp/carService/carServiceTemplate.html",link:function(e,t,r){$("body").delegate(".js-filter","click",function(){$(this).prev(".wrap-filter").slideToggle("slow")}),$("body").delegate(".js-filter","click",function(){$(this).toggleClass("filter-up filter-down")}),$(".jelect").jelect()},controller:"carServiceController"}}),angular.module("psApp").filter("formatToCss",function(){return function(e){return e?e.replace(/\(|\)|&|$|\@ |! |-|\+|,/g,"").replace(/  /g,"-").replace(/ /g,"-"):""}}),angular.module("psApp").directive("centreDetails",function(){return{templateUrl:"psApp/carService/centerDetails.html",replace:!0,scope:{centre:"=",add:"&"},controller:["$scope",function(e){e.isDisplaySelected=e.centre.activeCentre,e.selectedCentre=function(){e.add({dirCentre:e.centre})}}]}});var placeSearch,autocomplete,autocomplete_textarea,googleMapHolder,map,googleMapMarkers=[],displayCurrentLocation,latlon,userLocation={},locationCall,draggable,infowindow=google.maps?new google.maps.InfoWindow:"",geocoder=google.maps?new google.maps.Geocoder:"",componentForm={sublocality_level_1:"short_name",sublocality_level_2:"short_name",administrative_area_level_2:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},mapOptions={center:latlon,zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP};angular.module("psApp").controller("selectAddressController",["$scope","$window","$state","$location","$localStorage","psDataServices","psOrderDetailsService",function(e,t,r,o,a,n,s){e.payNow=!0,e.oldNumber=a.userDetails?a.userDetails.phoneNo:void 0,e.checkMobileNumber=function(){a.userDetails.phoneNo==e.oldNumber&&$(".mobile_validation").hide()},e.orderProcessingTC=function(e,t){window.open(e,t)},e.orderProcess=function(){e.payNow?(n.setPaymentMode("Online"),a.userSelectionData=n.getSelectedService(),e.response=s.payment().then(function(r){0==r.status?null!=r.result&&(t.location.href=r.result.payment_request.longurl):(1==r.status||2==r.status)&&(e.reqError=!0,e.errorMessage=r.message)},function(e){})["finally"](function(){})):(n.setPaymentMode("COD"),e.orderSubmit("","",""))},e.orderSubmit=function(t,o,a){s.submitOrder(t,o,a).then(function(t){0===t.status?(e.receivedOrder=t.result,r.go("orderSuccess")):(1===t.status||2===t.status)&&(e.orderErrorMessage=t.result,r.go("orderError"))},function(){alert("Sorry we are unable to process your order. Please try after some time")})};var i=o.search();null!=i.payment_id&&null!=i.payment_request_id&&s.validateOrder(i.payment_id,i.payment_request_id).success(function(t){0==t.status&&1==t.result.success&&e.orderSubmit(i.payment_id,i.payment_request_id,t.result)}).error(function(){alert("error")}),e.ReviewOrder=function(){e.reviewOrder=[];var t=n.getSelectedService();e.review=!0,e.reviewOrder.push(t),$("#ReviewOrder").modal()}}]),angular.module("psApp").directive("selectAddress",function(){return{templateUrl:"psApp/carService/selectAddress.html",controller:"selectAddressController",link:function(e,t,r){}}}),angular.module("psApp").directive("selectCar",function(){return{templateUrl:"psApp/carService/selectCar.html",link:function(e,t,r){}}}),angular.module("psApp").controller("selectCentreController",["$scope","psDataServices","$state","$localStorage",function(e,t,r,o){function a(){removeMarker()}e.state=r,e.selectedCentre="",e.selectServiceCentre=function(o){o.activeCentre?(t.setSelectedCentre(e.selectedCentre),r.go("service.appointment")):(e.selectedCentre.activeCentre=!1,o.activeCentre=!0,e.selectedCentre=o,myClick(o.$$hashKey,e.centreList))},e.getCentreDetails=function(r){r||(r=e.area),o.userData.area=r,r&&"select area"!==r.toLowerCase()?t.getServiceCentreList(e.city,r).success(function(t){t.length>0?(a(),e.centreList=[],e.centreList=t,e.selectedCentre=e.centreList[0],e.selectedCentre.activeCentre=!0,e.recommendedCentre=e.centreList[0],e.centreList[e.centreList.indexOf(e.selectedCentre)].activeCentre=!0,setMarkers(e.map,e.centreList,e.markerClick),e.noCentreMatch=!1):(e.noCentreMatch=!0,e.centreList=[],e.selectedCentre={},e.recommendedCentre={})}).error(function(){}):(a(),e.centreList=[],e.selectedCentre={},e.recommendedCentre={})},t.getServiceCentreCity().success(function(t){e.car.centreCity=t}),e.setUserLocation=function(e,t){o.userData.lat=e,o.userData.lng=t},e.getServiceCentreArea=function(){o.userData.city=e.city,"select city"!==e.city.toLowerCase()?t.getServiceCentreArea(e.city).success(function(t){a(),e.car.centreArea=t,e.car.centreArea.includes(e.googleMapArea)&&(e.area=e.googleMapArea,$(".select.jelect").find("#areaDropDown").text(e.googleMapArea),e.googleMapArea=""),e.getCentreDetails(e.googleMapArea)}):(e.car.centreArea={},a(),$(".select.jelect").find("#areaDropDown").text("Select Area"),e.centreList=[],e.selectedCentre={},e.recommendedCentre={})},e.markerClick=function(t){t.$$hashKey!=e.selectedCentre.$$hashKey&&(e.selectedCentre.activeCentre=!1,t.activeCentre=!0,e.selectedCentre=t,e.$apply())},e.changeArea=function(){e.area&&"select area"!==e.area.toLowerCase()&&$("#addressOverlay").modal("toggle")},e.MapCallback=function(r,a){e.googleMapArea=a,o.userData.area=a,o.userData.city=r,t.setuserAddress(e.userAddress),e.car.centreCity.includes(r)&&(e.city=r,$(".select.jelect").find("#cityDropDown").text(r),e.getServiceCentreArea())},o.userData.area&&($(".select.jelect").find("#cityDropDown").text(o.userData.city),$(".select.jelect").find("#areaDropDown").text(o.userData.area),e.city=o.userData.city,e.getServiceCentreArea())}]),angular.module("psApp").directive("selectCentre",function(){return{templateUrl:"psApp/carService/selectCentre.html",link:function(e,t,r){function o(){navigator.geolocation?navigator.geolocation.getCurrentPosition(a,handleError):error("Google Map is not supported")}function a(t){var r=t.coords.latitude,o=t.coords.longitude;e.setUserLocation(r,o),g.lat=r,g.lng=o,e.selectUserLocation()}function n(){var t=new google.maps.LatLng(g.lat,g.lng);s(t),u.center=t,e.setUserLocation(g.lat,g.lng),c=new google.maps.Map(document.getElementById("userAddressMap"),u),l=null,l=new google.maps.places.Autocomplete(document.getElementById("users_formatted_address"),{types:["geocode"]}),google.maps.event.addListener(l,"place_changed",i),d=new google.maps.Marker({position:t,map:c,draggable:!0}),google.maps.event.addListener(d,"drag",function(){e.setUserLocation(d.position.lat(),d.position.lng()),g.lat=d.position.lat(),g.lng=d.position.lng(),s(t)})}function s(e){var t={latLng:e};callGeoCoderApi(t).then(function(e){document.getElementById("users_formatted_address")&&(document.getElementById("users_formatted_address").value=e.result.formatted_address)})}function i(t){m.close(),d.setVisible(!1);var r=l.getPlace();r.geometry.viewport?c.fitBounds(r.geometry.viewport):(c.setCenter(r.geometry.location),c.setZoom(15)),g.lat=r.geometry.location.lat(),g.lng=r.geometry.location.lng(),e.setUserLocation(g.lat,g.lng),d.setPosition(r.geometry.location),d.setVisible(!0),p=r}var c,l,d,p,u={zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}},m=google.maps?new google.maps.InfoWindow:"",g=(google.maps?new google.maps.Geocoder:"",{lat:"",lng:""});$(".jelect").jelect(),o(),t.delegate("#users_formatted_address","focus",function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),r=new google.maps.Circle({center:t,radius:5e4});l.setBounds(r.getBounds())})}),e.selectUserLocation=function(){function t(){var t={center:o,zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP},r=new google.maps.Map(document.getElementById("mapholder"),t);e.map=r}var r,o=new google.maps.LatLng(g.lat,g.lng);if(t(),p)r=getCityAreaFromAddressComponent(p),e.userAddress=r,e.MapCallback(r.city,r.area);else{var a={latLng:o};callGeoCoderApi(a).then(function(t){r=getCityAreaFromAddressComponent(t.result),e.userAddress=r,e.MapCallback(r.city,r.area)})}},$("#addressOverlay").on("shown.bs.modal",function(){if(""!=g.lat)c||n();else{var t={address:e.area};callGeoCoderApi(t).then(function(e){g.lat=e.result.geometry.location.lat(),g.lng=e.result.geometry.location.lng(),n()})}})},controller:"selectCentreController"}}),angular.module("psApp").directive("psAboutUs",[function(){return{scope:{},template:"<about-us></about-us>",link:function(e){}}}]),angular.module("psApp").directive("psContactUs",[function(){return{scope:{},template:"<contact-us></contact-us>",link:function(e){}}}]),angular.module("psApp").directive("psDashboard",[function(){return{scope:{},template:"<dashboard></dashboard>",link:function(e){}}}]),angular.module("psApp").directive("psIndex",[function(){return{scope:{},template:"<index></index>",link:function(e){}}}]),angular.module("psApp").directive("psOrderProcessing",[function(){return{scope:{},template:"<order-processing-terms></order-processing-terms>",link:function(e){}}}]),angular.module("psApp").directive("psPricing",[function(){return{scope:{},template:"<pricing></pricing>",link:function(e){}}}]),angular.module("psApp").directive("psPrivacyPolicy",[function(){return{scope:{},template:"<privacy-policy></privacy-policy>",link:function(e){}}}]),angular.module("psApp").directive("psTerms",[function(){return{scope:{},template:"<terms></terms>",link:function(e){}}}]),angular.module("psApp").directive("footerContent",function(){return{templateUrl:"psApp/footerContent/footerContentTemplate.html",link:function(e,t,r){$(function(){$(".scroll[href*=#]:not([href=#])").click(function(){var e=$(this.hash);return e=e.length?e:$("[name="+this.hash.slice(1)+"]"),e.length?($("html,body").animate({scrollTop:e.offset().top},1e3),!1):void 0})});var o=$(window).width();o>1200&&$(window).scroll(function(){$(".animatedEntrance").each(function(){var e=$(this).offset().top,t=$(window).scrollTop();t+400>e&&$(this).addClass("slideUp")})})}}}),angular.module("psApp").directive("collapsable",["$timeout",function(e){return{replace:!0,scope:{data:"="},templateUrl:"psApp/headerContent/CollapsableTemplate.html"}}]),angular.module("psApp").controller("headerContentController",["$scope","$localStorage","$location","$rootScope","$state","psLoginService",function(e,t,r,o,a,n){e.isLoggedIn=t.userDetails?!0:!1,e.userDetails=t.userDetails?t.userDetails:"",o.$on("ps-user-profile-show",function(t,r){e.isLoggedIn=r.isLoggedIn,e.userDetails=r.userDetails}),e.openloginModal=function(){$("#loginModal").modal("toggle"),$("#signin-taba").tab("show")},e.logout=function(){e.isLoggedIn=!1,n.setUserAuthenticated(!1),t.userDetails=void 0,a.go("home")}}]),angular.module("psApp").directive("headerContent",function(){return{templateUrl:"psApp/headerContent/headerContentTemplate.html",controller:"headerContentController",link:function(e,t,r,o){makeSyickyHeader(),scrollBackToTop(),$("a.back-to-top").click(function(){return $("html, body").animate({scrollTop:0},700),!1})}}}),angular.module("psApp").factory("psOrderDetailsService",["$http","$q","$localStorage","psDataServices",function(e,t,r,o){var a,n,s=function(t,r){var o={PaymentId:t,PaymentRequestId:r};return e({url:"/api/services/validateOrder",method:"POST",data:o})},i=function(s,i,c){a=o.getSelectedService(),""!=s&&(a=r.userSelectionData);var l=t.defer();a.PaymentId=s,a.PaymentRequestId=i,a.PaymentResponse=c;var d=a;return e({url:"/api/services/order",method:"POST",data:d}).then(function(e){r.userSelectionData="",n=e.data.result,l.resolve(e.data)},function(e){l.reject(e)}),l.promise},c=function(){a=o.getSelectedService();var r=t.defer();return e.post("/api/Auth/ProcessPayment?name="+a.userDetails.userName+"&purpose=MileMates Service Payment&amount="+a.selectedCentre.totalPrice+"&email="+a.userDetails.email+"&phone="+a.userDetails.phoneNo+"&send_email="+!1+"&send_sms="+!1).then(function(e){r.resolve(e.data)},function(e){r.reject(e)}),r.promise},l=function(){return n},d=function(o){var a=t.defer();return e({url:"/api/OrderDetails/order?email="+r.userDetails.email+"&status="+o,method:"GET"}).then(function(e){a.resolve(e.data.result)},function(e){a.reject(e)}),a.promise},p=function(r,o){var a=t.defer();return e({url:"/api/OrderDetails/cancelorder?invoiceNo="+r+"&email="+o,method:"GET"}).then(function(e){a.resolve(e.data.result)},function(e){a.reject(e)}),a.promise},u=function(r,o){var a={dropOffDate:"",pickUpDate:""};a.dropOffDate=o.dropOffDate;var n=t.defer();return e({url:"/api/OrderDetails/editOrder?InvoiceNo="+r+"&dropOffDate="+o.dropOffDate.day+"&dropOffTime="+o.dropOffDate.time+"&pickUpDate="+o.pickUpDate.day+"&pickUpTime="+o.pickUpDate.time,method:"POST"}).then(function(e){n.resolve(e.data)},function(e){n.reject(e)}),n.promise};return{payment:c,validateOrder:s,submitOrder:i,getsubmittedOrder:l,getAllPendingOrder:d,cancelOrder:p,editDateAndTime:u}}]),angular.module("psApp").factory("psLoginService",["$http","$q","$localStorage",function(e,t,r){var o=r.isAuthenticated?r.isAuthenticated:!1,a=function(r,o){var a=t.defer();return e.post("/api/Auth/Login?Email="+r+"&Password="+o).then(function(e){a.resolve(e.data)},function(e){a.reject(e)}),a.promise},n=function(r,o,a,n,s){var i=t.defer();return e.post("/api/Auth/Register?FirstName="+r+"&LastName="+o+"&Email="+a+"&Mobile="+n+"&Password="+s).then(function(e){i.resolve(e.data)},function(e){i.reject(e)}),i.promise},s=function(r,o){var a=t.defer();return e.post("/api/Auth/Subscribe?Name="+r+"&Email="+o).then(function(e){a.resolve(e.data)},function(e){a.reject(e)}),a.promise},i=function(r){var o=t.defer();return e.post("/api/Auth/MobileOTP?MobileNumber="+r).then(function(e){o.resolve(e.data)},function(e){o.reject(e)}),o.promise},c=function(r){var o=t.defer();return e.post("/api/Auth/ForgotPassword?Email="+r).then(function(e){o.resolve(e.data)},function(e){o.reject(e)}),o.promise},l=function(r){var o=t.defer();return e.post("/api/Auth/SocialLogin?Id="+r).then(function(e){o.resolve(e.data)},function(e){o.reject(e)}),o.promise},d=function(r){var o=t.defer();return e.post("/api/Auth/Success?Code="+r.code).then(function(e){o.resolve(e.data)},function(e){o.reject(e)}),o.promise},p=function(r){var o=t.defer();return e.post("/api/Auth/UpdateProfile?firstName="+r.firstName+"&lastName="+r.lastName+"&mobile="+r.mobile+"&email="+r.email).then(function(e){o.resolve(e.data)},function(e){o.reject(e)}),o.promise},u=function(r){var o=t.defer();return e.post("/api/Auth/ChangePassword?email="+r.email+"&oldPassword="+r.oldPassword+"&newPassword="+r.newPassword).then(function(e){o.resolve(e.data)},function(e){o.reject(e)}),o.promise},m=function(e){o=e,r.isAuthenticated=e},g=function(){return o};return{login:a,register:n,forgotPassword:c,socialLogin:l,socialCallback:d,mobileVerification:i,subscribe:s,updatePassword:u,updateProfile:p,setUserAuthenticated:m,isAuthenticated:g
}}]),angular.module("psApp").factory("psDataServices",["$http","$q","$localStorage",function(e,t,r){var o,a,n,s={selectedCar:{},selectedServices:{},selectedCentre:{},selectedAppointment:{},userDetails:{},userAddress:{}};angular.extend(s.userDetails,r.userDetails);var i=function(){return s},c=function(e,t,r,n,i){o=e,a=t,s.selectedCar=e,s.selectedServices=t},l=function(e){n=e},d=function(e){s.selectedAppointment=e},p=function(e){s.PaymentMode=e},u=function(){return s.userDetails},m=function(e){s.userDetails=e,r.userDetails=e},g=function(){return s.userAddress},f=function(e){s.userAddress=e,r.userAddress=e,r.userAddress.lat=r.userData.lat,r.userAddress.lng=r.userData.lng},v=function(e){s.selectedCentre=e},h=function(){return e.get("/api/car")},C=function(t){return e.get("/api/car/"+t)},w=function(t,r){return e.get("/api/car/"+t+"/"+r)},y=function(t){return e.get("/api/ServiceCentre/")},D=function(t){return e.get("/api/ServiceCentre/"+t)},A=function(t,a){var s=n,i={City:t,Area:a,Name:s,Model:o.model,Type:o.varient,Latitude:r.userData.lat,Longitude:r.userData.lng};return e({url:"/api/ServiceCentre/centerlist",method:"POST",data:i})},S=function(t,r){return e.get("/api/services/all")},$=function(){var t={carDetails:s.selectedCar,CustType:r.userDetails.customerType,Email:r.userDetails.email};return e({url:"/api/car/save",method:"POST",data:t})},b=function(){return e({url:"/psApp/data/serviceCentre.json",method:"get"})},k=function(t){var r=[];r.push(t);var o={Area:t.Area,Centres:r};return e({url:"/api/ServiceCentre/save",method:"POST",data:o})};return{getAllCarColletion:h,getCarType:C,getCarVarient:w,getServiceCentreCity:y,getServiceCentreArea:D,getServiceCentreList:A,getAllService:S,setSelectedCarAndService:c,getSelectedService:i,setSelectedServiceName:l,setSelectedCentre:v,setSelectedAppointment:d,setPaymentMode:p,getuserDetails:u,setuserDetails:m,getuserAddress:g,setuserAddress:f,setUserPreference:$,geMockData:b,saveCentreDetails:k}}]),angular.module("psApp").directive("switcherContent",function(){return{templateUrl:"psApp/switcherContent/switcherContentTemplate.html"}}),angular.module("psApp").directive("psUserProfile",["$rootScope",function(e){return{templateUrl:"psApp/userProfile/userProfileTemplate.html",replace:!0,link:function(e,t,r,o){}}}]),angular.module("psApp").directive("bookAppointment",function(){return{templateUrl:"psApp/carService/bookAppointment/bookAppointment.html",link:function(e,t,r){},scope:!1,controller:["$scope","psDataServices",function(e,t){function r(t,r){var o=new Date;r&&o.setDate(parseInt(e.selectedDate.pickUpDate.day.split(" ")[2])+1),e.disablePrevBtn=n.toDateString()===t[0].day?!0:!r||e.selectedDate.pickUpDate.day!==t[0].day&&o.toDateString()!==t[0].day?!1:!0,e.disableNextBtn=c.toDateString()===t[t.length-1].day?!0:!1}function o(e){var t=e,r="AM",o=t;return o>=12&&(o=t-12,r="PM"),0==o&&(o=12),o+" "+r}function a(e,t){return t.toDateString()===n.toDateString()?e>s?!0:!1:!0}e.dateToDisplay=[],e.timeToDisplay=[8,9,10,11,12,13,14,15,16,17,18,19],e.hideCalendar=!1,e.showPickUpCalendar=!0,e.centreWorkingHours=[],e.availablePickUpTime=[],e.userSelectedService={};var n=new Date,s=n.getHours(),i=n.getDate(),c=new Date;c.setDate(i+14),e.setFiveDay=function(t,r){for(var s,i=t.getDate(),l=[],d=0;8>d;d++){var p=[],u=new Date(t);u.setDate(i),s=u;var m=s.toDateString();if(e.selectedDate.pickUpDate.day==m&&r){var g=r.split(" ");g="AM"===g[1]?g[0]:12!==g[0]?12+parseInt(g[0]):g[0];var f=e.timeToDisplay.indexOf(parseInt(g)+6);f>-1?e.timeToDisplay.splice(0,f):e.timeToDisplay=[]}else e.timeToDisplay=[8,9,10,11,12,13,14,15,16,17,18,19];if($.each(e.timeToDisplay,function(e,t){if(s.toDateString()===n.toDateString()&&a(t,s)){var r={time:o(t)};p.push(r)}else{var r={time:o(t)};p.push(r)}}),p.length>0&&l.push({day:m,WorkingHours:p}),i++,5==l.length||c.toDateString()==m)break}return l},e.selectedDate={pickUpDate:{},dropOffDate:{}},e.selectpickUpTime=function(o){e.selectedDate.dropOffDate={},e.selectedDate.pickUpDate.day=o.day,e.selectedDate.pickUpDate.time=o.time;var a=new Date;a.setDate(o.day.split(" ")[2]),e.availablePickUpTime=e.setFiveDay(a,o.time),r(e.availablePickUpTime,!0),e.showPickUpCalendar=!1,e.showDropCalendar=!0,t.setSelectedAppointment(e.selectedDate),e.userSelectedService=t.getSelectedService(),e.mapUrl="http://maps.googleapis.com/maps/api/staticmap?&zoom=15&scale=false&size=500x300&maptype=roadmap&format=png&visual_refresh=true&markers="+e.userSelectedService.userAddress.lat+","+e.userSelectedService.userAddress.lng},e.selectDropTime=function(r){e.selectedDate.dropOffDate.day=r.day,e.selectedDate.dropOffDate.time=r.time,e.showDropCalendar=!1,e.hideCalendar=!0,t.setSelectedAppointment(e.selectedDate)},e.nextDates=function(t){var o=e.showPickUpCalendar?e.centreWorkingHours:e.availablePickUpTime,a="prev"===t?o[0].day:o[e.centreWorkingHours.length-1].day;a=new Date(a);var n=a.getDate();a.setDate("prev"===t?n-5:n+1),e.showPickUpCalendar?(e.centreWorkingHours=e.setFiveDay(a),r(e.centreWorkingHours)):(e.availablePickUpTime=e.setFiveDay(a,e.selectedDate.pickUpDate.time),r(e.availablePickUpTime,!0))},e.centreWorkingHours=e.setFiveDay(n),r(e.centreWorkingHours),e.editPickUpDate=function(){e.showPickUpCalendar=!e.showPickUpCalendar,e.showPickUpCalendar?(e.hideCalendar=!1,e.showDropCalendar=!1,r(e.centreWorkingHours)):e.hideCalendar=!0},e.editDropDate=function(){e.showDropCalendar=!e.showDropCalendar,e.showDropCalendar?(e.hideCalendar=!1,e.showPickUpCalendar=!1,r(e.availablePickUpTime,!0)):e.hideCalendar=!0}}]}}),angular.module("psApp").directive("calendarDirective",function(){return{templateUrl:"psApp/carService/bookAppointment/calendar.html",replace:!0,scope:{data:"=",update:"&"},controller:["$scope",function(e){e.updateTime=function(t,r){e.selectedDate={},e.selectedDate.time=t,e.selectedDate.day=r,e.update({selectedDateTime:e.selectedDate})}}]}}),angular.module("psApp").directive("orderSummary",function(){return{templateUrl:"psApp/carService/orderSummary/orderSummary.html",link:function(e,t,r){},controller:["$scope","$location","psOrderDetailsService",function(e,t,r){e.orderDetails=r.getsubmittedOrder(),e.go=function(e){t.path(e)}}]}}),angular.module("psApp").directive("reviewOrder",function(){return{templateUrl:"psApp/carService/reviewOrder/reviewOrder.html",replace:!0,scope:{orders:"="}}});