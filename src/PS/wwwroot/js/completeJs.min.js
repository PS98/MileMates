!function(){"use strict";angular.module("myApp",["ngRoute","appDirective"]).config(["$routeProvider",function(e){e.when("/",{controller:"topicsController",controllerAs:"vm",templateUrl:"/template/topicsView.html"}),e.when("/newMessage",{controller:"newTopicController",controllerAs:"vm",templateUrl:"/template/NewTopicView.html"}),e.when("/message/:id",{controller:"singleTopicController",controllerAs:"vm",templateUrl:"/template/singleTopicView.html"}),e.otherwise({redirectTo:"/"})}])}(),function(){"use strict";function e(e,t,n){e.data=n,e.isBusy=!0,0==n.isReady()&&(e.isBusy=!0,n.getTopics().then(function(e){},function(){alert("Could not load topics.")})["finally"](function(){e.isBusy=!0}))}function t(e,t,n,o){e.newTopic={},e.save=function(){o.addTopic(e.newTopic).then(function(e){n.location="#/"},function(){alert("Could not load topics.")})["finally"](function(){e.isBusy=!1})}}function n(e,t,n,o){e.topic=null,e.newReply={},o.getTopicById(t.id).then(function(t){e.topic=t},function(){n.location="#/"}),e.addReply=function(){o.saveReply(e.topic,e.newReply).then(function(t){e.newReply.body=""},function(){alert("Could not save the new reply.")})}}e.$inject=["$scope","$http","dataService"],t.$inject=["$scope","$http","$window","dataService"],n.$inject=["$scope","$routeParams","$window","dataService"];var o=angular.module("myApp");o.$inject=["dataService"],o.controller("topicsController",e),o.controller("newTopicController",t),o.controller("singleTopicController",n)}(),function(){"use strict";function e(){return{scope:{show:"=displayWhen"},restrict:"E",templateUrl:"/template/waitCursor.html"}}angular.module("appDirective",[]).directive("waitCursor",e)}(),function(){"use strict";var e=angular.module("myApp");e.factory("dataService",["$http","$q",function(e,t){function n(e){var t=null;return $.each(o,function(n,o){return o.id==e?(t=o,!1):void 0}),t}var o=[],i=!1,r=function(){return i},c=function(){var n=t.defer();return e.get("/api/topics?includeReplies=true").then(function(e){angular.copy(e.data,o),i=!0,n.resolve()},function(){n.reject()}),n.promise},l=function(n){var i=t.defer();return e.post("/api/topics",n).then(function(e){var t=e.data;o.splice(0,0,t),i.resolve(t)},function(){i.reject()}),i.promise},a=function(e){var o=t.defer();if(r()){var i=n(e);i?o.resolve(i):o.reject()}else c().then(function(){var t=n(e);t?o.resolve(t):o.reject()},function(){o.reject()});return o.promise},u=function(n,o){var i=t.defer();return e.post("/api/topics/"+n.id+"/replies",o).then(function(e){null==n.replies&&(n.replies=[]),n.replies.push(e.data),i.resolve(e.data)},function(){i.reject()}),i.promise};return{topics:o,getTopics:c,addTopic:l,isReady:r,getTopicById:a,saveReply:u}}])}();